<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UniHive</title>

    <!-- Google Fonts (Poppins) -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" />

    <!-- Font Awesome (for icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

    <link rel="stylesheet" href="globals.css" />
    <link rel="stylesheet" href="style.css" />
</head>
<style>
    body {
        font-family: "Poppins", sans-serif;
        background-color: #000511;
        margin: 0;
        color: #fff;
    }
    /* Modal backdrop */
    
    #lostFoundModalBackdrop {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        /* Dimmed background */
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 999;
    }
    /* Modal container */
    
    #lostFoundModal {
        background: white;
        border-radius: 12px;
        padding: 24px;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        display: flex;
        flex-direction: column;
        gap: 15px;
        animation: fadeIn 0.3s ease-in-out;
    }
    /* Smooth fade-in */
    
    @keyframes fadeIn {
        from {
            transform: translateY(-20px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }
    /* Form elements */
    
    #lostFoundModal input,
    #lostFoundModal textarea {
        width: 100%;
        padding: 10px 12px;
        border-radius: 8px;
        border: 1px solid #ccc;
        font-size: 14px;
        outline: none;
        transition: border-color 0.3s;
    }
    
    #lostFoundModal input:focus,
    #lostFoundModal textarea:focus {
        border-color: #007bff;
    }
    /* Submit button */
    
    #modalSubmit {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 12px;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.2s ease;
    }
    
    #modalSubmit:hover {
        background-color: #0056b3;
    }
    /* Radio labels */
    
    #lostFoundModal label {
        margin-right: 10px;
        font-size: 14px;
        display: inline-flex;
        align-items: center;
        gap: 4px;
    }
    
    .main-content {
        display: flex;
        flex-wrap: wrap;
        margin: 0 auto;
        padding: 20px;
    }
    
    .main-feed {
        width: 100%;
        max-width: 1300px;
        /* You can adjust this if needed */
        margin: 0 auto;
        padding: 0 20px;
        box-sizing: border-box;
    }
    
    .user-actions {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .announcements {
        color: #000511;
        width: 100%;
        background-color: #ffffff;
        padding: 60px 16% 16% 16%;
        margin-bottom: 20px;
        border: 1px solid #121528;
        position: relative;
        min-width: 900px;
    }
    /* Add media query for responsive positioning */
    
    @media screen and (max-width: 1200px) {
        .user-actions {
            right: 20px;
        }
    }
    
    .announcements {
        color: #000511;
        width: 100%;
        background-color: #ffffff;
        padding: 16%;
        margin-bottom: 20px;
        border: 1px solid #121528;
        position: relative;
    }
    
    .sidebar {
        width: 40%;
    }
    /****************************************************
  HEADER
*/
    
    header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 20px;
        background-color: #000511;
        width: 100%;
        font-family: "Poppins", sans-serif;
        text-decoration: none;
    }
    
    .branding {
        display: flex;
        align-items: center;
        gap: 15px;
    }
    
    .logo {
        width: 89px;
        height: 89px;
    }
    
    .site-title {
        font-size: 36px;
        color: #fea303;
        font-weight: 600;
    }
    
    .main-nav {
        flex-grow: 1;
        display: flex;
        justify-content: center;
    }
    
    .main-nav ul {
        display: flex;
        gap: 24px;
        list-style: none;
        margin: 0;
        padding: 0;
    }
    
    .main-nav a {
        color: #fea303;
        font-weight: 800;
        font-size: 18px;
        text-decoration: none;
        padding: 8px 12px;
        border-radius: 18px;
        transition: background-color 0.2s ease;
    }
    
    .main-nav a.active {
        background-color: #fea303;
        color: #000511;
    }
    
    .main-nav a:hover {
        background-color: #fea30333;
    }
    
    .announcements {
        color: #000511;
        width: 100%;
        background-color: #ffffff;
        padding: 60px 16% 16% 16%;
        margin-bottom: 20px;
        border: 1px solid #121528;
        position: relative;
    }
    
    .search {
        width: 40px;
        height: 40px;
    }
    
    .notification {
        background: none;
        border: none;
        cursor: pointer;
    }
    
    .notification i {
        color: #fea303;
        font-size: 1.7rem;
    }
    
    .profile {
        width: 40px;
        height: 40px;
        background-color: #d9d9d9;
        border-radius: 50%;
    }
    /****************************************************
  ANNOUNCEMENTS
*****************************************************/
    
    .announcements {
        color: #000511;
        width: 100%;
        background-color: #ffffff;
        padding: 16%;
        margin-bottom: 20px;
        border: 1px solid #121528;
        position: relative;
    }
    
    .announcements h2 {
        font-size: 3rem;
        font-weight: 600;
        color: #fea303;
    }
    /*
  CTA TEXT
*/
    
    .cta-text {
        font-size: 1.4rem;
        font-weight: 600;
        color: #fff;
        margin: 20px 0;
    }
    /*
  POST FORM
*/
    
    .post-form {
        background-color: #fefefe;
        padding: 16px;
        margin-bottom: 20px;
        color: #333;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        gap: 12px;
        border-radius: 15px;
    }
    
    .post-form,
    .post {
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
        word-wrap: break-word;
        overflow-wrap: break-word;
        overflow-x: hidden;
    }
    /* Top row: Username + Topic */
    
    .form-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .username-container {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
    }
    /* Remove border from the username input */
    
    .username-input {
        background: #fff;
        border: none;
        padding: 6px 10px;
        border-radius: 4px;
        font-size: 0.9rem;
        color: #333;
    }
    /* Topic dropdown */
    
    .topic-dropdown select {
        background: #e2dddd;
        border: none;
        padding: 6px 10px;
        border-radius: 10px;
        font-size: 0.9rem;
        color: #333;
        cursor: pointer;
    }
    /* Middle: textarea */
    
    .post-textarea {
        width: 100%;
        min-height: 80px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 6px;
        resize: none;
        font-size: 0.95rem;
        color: #333;
    }
    /* Bottom row: Choose Image + File Name + Post, right-aligned */
    
    .form-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #ffffff;
        padding: 10px 16px;
        border-top: 1px solid #ddd;
        border-radius: 0 0 12px 12px;
        /* rounded bottom only */
        margin-top: auto;
        gap: 10px;
    }
    /* Custom "Choose Image" button */
    
    .custom-file-button {
        background: #d4d4d4;
        border-radius: 4px;
        padding: 8px 12px;
        font-size: 12px;
        size: 50%;
        color: #333;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        border: 1px solid #ccc;
        transition: background 0.2s ease;
    }
    
    .custom-file-button:hover {
        background: #5e5d5d;
    }
    
    .img-icon {
        width: 20px;
        height: 20px;
    }
    
    #selected-file-name {
        font-size: 0.85rem;
        color: #555;
    }
    /* "Post" button */
    
    .submit-post {
        background-color: #fea303;
        color: #000;
        padding: 10px 18px;
        border: none;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.95rem;
        transition: background-color 0.2s ease;
        cursor: pointer;
    }
    /*
  POSTS + COMMENTS
*/
    
    .post {
        background-color: #fff;
        color: #333;
        border-radius: 8px;
        margin-bottom: 20px;
        padding: 1rem;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
    }
    
    .post header {
        display: flex;
        align-items: center;
        gap: 10px;
        background-color: #ffffff;
    }
    
    .post header h3 {
        font-size: 1rem;
        font-weight: 600;
        margin: 0;
    }
    
    .post-tag {
        font-size: 0.75rem;
        background-color: #d0325a;
        color: white;
        padding: 2px 8px;
        border-radius: 12px;
        margin-top: 2px;
        width: fit-content;
    }
    /* Make the bottom orange */
    
    .post footer {
        background-color: #fea303;
        color: #000;
        margin-top: 0.75rem;
        padding: 0.75rem;
        border-bottom-left-radius: 8px;
        border-bottom-right-radius: 8px;
        display: flex;
        align-items: center;
    }
    
    .like-button,
    .comment-button {
        background: transparent;
        border: none;
        cursor: pointer;
        font-size: 1rem;
        flex: 1;
        /* each gets half the row */
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        /* center icon + text */
        gap: 6px;
        color: #000;
        /* text color on orange background */
    }
    
    .like-button.liked {
        color: #000000;
        font-weight: bold;
    }
    
    .more-options-wrapper {
        margin-left: auto;
        position: relative;
    }
    
    .more-options {
        background: none;
        border: none;
        font-size: 1.4rem;
        font-weight: bold;
        color: #000000;
        cursor: pointer;
        margin-left: auto;
    }
    /* Smaller font-size and padding for the delete/report menu */
    
    .options-menu {
        position: absolute;
        top: 1.8rem;
        right: 0;
        background: #fff;
        border: 1px solid #ddd;
        list-style: none;
        padding: 0;
        margin: 0;
        border-radius: 4px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        display: none;
    }
    
    .options-menu li {
        padding: 4px 8px;
        /* smaller padding than before */
        font-size: 0.8rem;
        /* smaller font size */
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
    }
    
    .options-menu li:hover {
        background-color: #f0f0f0;
    }
    
    .comment-section {
        margin-top: 0.75rem;
        border-top: 1px solid #ccc;
        padding-top: 0.75rem;
        display: none;
        background-color: #f7f7f7;
        border-left: 4px solid #fea303;
        padding: 1rem;
        border-radius: 6px;
        margin-left: 10px;
        margin-right: 10px;
    }
    
    .comment-input {
        width: 100%;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-bottom: 8px;
        padding: 8px;
        font-size: 0.9rem;
        color: #333;
    }
    
    .submit-comment {
        padding: 8px 14px;
        background-color: #fea303;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        color: #000511;
    }
    
    .comments-list .comment-entry {
        background: #f5f5f5;
        border-radius: 4px;
        padding: 8px;
        margin: 6px 0;
        display: flex;
        gap: 8px;
        align-items: flex-start;
    }
    
    .comment-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
    }
    
    .comment-body {
        flex: 1;
    }
    
    .comment-time {
        font-size: 0.75rem;
        color: #888;
        margin-left: 6px;
    }
    
    .comment-actions {
        margin-top: 6px;
        display: flex;
        gap: 10px;
    }
    
    .comment-actions button {
        background: none;
        border: none;
        font-size: 0.8rem;
        color: #444;
        cursor: pointer;
    }
    
    .comment-actions button:hover {
        color: #222;
    }
    /*
  SIDEBAR & EXTRA
*/
    
    .sidebar .clubs h2 {
        font-size: 32px;
        font-weight: 700;
        color: #ffffff;
        margin-bottom: 10px;
    }
    
    .additional-content-1,
    .additional-content-2 {
        background-color: #d9d9d9;
        margin-bottom: 20px;
        padding: 15%;
        margin-top: 7%;
    }
    
    .Books {
        white-space: nowrap;
        display: inline;
        vertical-align: middle;
    }
    /* Footer */
    
    .page-footer {
        background-color: #DC9F3DDC;
        color: black;
        padding: 60px 5% 30px;
        border-radius: 100px;
        font-family: 'Noto Sans', serif;
        margin-top: 300px;
        width: 92%;
    }
    
    .footer-top {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 40px;
        margin-bottom: 50px;
    }
    
    .footer-logo {
        font-family: 'Noto Sans', serif;
        font-size: 18px;
        margin-bottom: 15px;
        background: linear-gradient(45deg, #ff7eb3, #f26ba3, #ef476f);
        -webkit-background-clip: text;
        background-clip: text;
        color: black;
    }
    
    .footer-about {
        max-width: 300px;
    }
    
    .social-links {
        display: flex;
        gap: 15px;
    }
    
    .social-icon {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background-color: #DC9F3DDC;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        transition: background-color 0.3s, transform 0.3s;
    }
    
    .social-icon:hover {
        background-color: #FF9D23;
        transform: translateY(-3px);
    }
    
    .footer-title {
        font-size: 18px;
        margin-bottom: 20px;
        position: relative;
        padding-bottom: 10px;
    }
    
    .footer-title::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 40px;
        height: 2px;
        background-color: black;
    }
    
    .footer-links {
        list-style: none;
    }
    
    .footer-links li {
        margin-bottom: 10px;
    }
    
    .footer-links a {
        color: black;
        text-decoration: none;
        transition: color 0.3s;
    }
    
    .footer-links a:hover {
        color: #481E14;
    }
    
    .contact-info {
        color: black;
    }
    
    .contact-info p {
        margin-bottom: 10px;
        display: flex;
        align-items: center;
    }
    
    .contact-info svg {
        margin-right: 10px;
        min-width: 20px;
    }
    
    .footer-bottom {
        border-top: 1px solid #444;
        padding-top: 20px;
        text-align: center;
        color: black;
        font-size: 14px;
    }
    
    .post-content {
        word-wrap: break-word;
        overflow-wrap: anywhere;
        white-space: pre-wrap;
        max-width: 100%;
        overflow: hidden;
    }
    
    .post-content,
    .comment-text {
        word-wrap: break-word;
        overflow-wrap: anywhere;
        white-space: pre-wrap;
        max-width: 100%;
    }
    
    .post-form,
    .post,
    .comment-section {
        max-width: 100%;
        overflow-x: hidden;
    }
    
    @import url("https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css");
     :root {
        --icons-color: rgba(41, 41, 41, 1);
    }
    
    * {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        box-sizing: border-box;
    }
    
    html,
    body {
        margin: 0;
        height: 100%;
    }
    
    body {
        color: #333;
        line-height: 1.5;
        font-family: "Poppins", sans-serif;
    }
    
    html {
        font-size: 16px;
    }
    
    a:focus,
    button:focus,
    input:focus,
    select:focus,
    textarea:focus {
        outline: none;
        box-shadow: none;
    }
    
    button:active,
    a:active {
        outline: none;
        box-shadow: none;
    }
    
    button:focus-visible {
        outline: none !important;
    }
    
    .visually-hidden {
        position: absolute !important;
        height: 1px;
        width: 1px;
        overflow: hidden;
        clip: rect(1px 1px 1px 1px);
        clip: rect(1px, 1px, 1px, 1px);
        white-space: nowrap;
    }
    
    a {
        text-decoration: none;
    }
</style>

<body>
    <div class="frame">
        <main class="main-content">
            <!-- HEADER -->
            <header>
                <img class="logo" src="https://c.animaapp.com/m9cq51g1Jevf3Y/img/1742586172225-1.png" alt="UniHive Logo" />
                <h1 class="site-title">UniHive</h1>
                <nav class="main-nav">
                    <ul>
                        <li><a href="#" class="active">Feed</a></li>
                        <li><a href="/lostnfound">Lost&Found</a></li>
                        <li><a href="/books" class="Books">Books Shop</a></li>
                    </ul>
                </nav>
                <div class="user-actions">
                    <!-- Search icon -->
                    <img class="search" src="https://c.animaapp.com/m9cq51g1Jevf3Y/img/image-8.png" alt="Search" />
                    <!-- Notification bell -->
                    <button class="notification" aria-label="Notifications">
              <i class="fas fa-bell"></i>
            </button>
                    <div class="profile" aria-label="User profile"></div>
                </div>
            </header>
            <!-- END HEADER -->

            <!-- ANNOUNCEMENTS SECTION -->
            <section class="announcements">
                <h2>Announcements</h2>
                <div id="announcement-list"></div>
            </section>

            <!-- MAIN FEED -->
            <section class="main-feed">
                <p class="cta-text">Don't wait and start buzzing <br />with the others</p>

                <!-- Redesigned Post Form -->
                <form class="post-form" action="/posts" method="post" enctype="multipart/form-data">
                    <!-- Form Header: Username + Topic Dropdown on the right -->
                    <div class="form-header">
                        <div class="username-container">
                            <img class="user-avatar" src="https://c.animaapp.com/m9cq51g1Jevf3Y/img/image-9.png" alt="User avatar" />
                            <input type="text" class="username-input" placeholder="username_" aria-label="Username" readonly />
                        </div>

                        <div class="topic-dropdown">
                            <label for="topic-select" class="visually-hidden">Select Topic</label>
                            <select id="topic-select" aria-label="Select topic" name="tags">
                  <option value="" disabled selected hidden>Topic</option>
                  <option value="tips">Tips</option>
                  <option value="general">General</option>
                  <option value="lost&found">Lost&Found</option>
<option value="help">Help</option>
                  <!-- Add more topics here -->
                </select>
                        </div>
                    </div>

                    <!-- Post content area -->
                    <textarea class="post-textarea" maxlength="500" name="content" placeholder="Say something..." aria-label="Post content"></textarea>

                    <!-- Form Footer: File Upload + Post Button -->
                    <div class="form-footer">
                        <!-- Custom file label + hidden file input -->
                        <label class="custom-file-button" for="image-upload">
                <i class="fas fa-image"></i> Image
              </label>
                        <!-- Show selected file name here -->
                        <span id="selected-file-name"></span>

                        <input id="image-upload" type="file" aria-label="Upload image" name="image" accept="image/*" hidden />

                        <button class="submit-post" type="submit">
                Post <i class="fas fa-plus"></i>
              </button>
                    </div>
                </form>
                <div id="lostFoundModalBackdrop">
                    <div id="lostFoundModal">
                        <label><input type="radio" name="type" value="lost"> Lost</label>
                        <label><input type="radio" name="type" value="found"> Found</label>
                        <input name="location" placeholder="Location" />
                        <input name="contact" placeholder="Contact Info" />
                        <textarea id="lost-found-response" placeholder="Describe the item or situation..."></textarea>
                        <input type="file" id="lost-found-image" name="image" />
                        <button id="modalSubmit">Submit</button>
                    </div>
                    <!-- END Post Form -->
                </div>
            </section>
            <!-- END MAIN FEED -->

            <!-- SIDEBAR -->
            <aside class="sidebar">
                <section class="clubs">
                    <h2>Clubs</h2>
                    <div class="clubs-content"></div>
                </section>

                <div class="additional-content-1"></div>
                <div class="additional-content-2"></div>
                <div class="additional-content-2"></div>
                <div class="additional-content-2"></div>
            </aside>
            <!-- END SIDEBAR -->
        </main>
    </div>
    <!-- Footer -->
    <footer class="page-footer">
        <div class="footer-top">
            <div class="footer-about">
                <h3 class="footer-logo">Helping students connect, share, and thrive</h3>
                <div class="social-links">
                    <a href="#" class="social-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
                        </svg>
                    </a>
                    <a href="#" class="social-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                            <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                            <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
                        </svg>
                    </a>
                    <a href="#" class="social-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
                        </svg>
                    </a>
                    <a href="#" class="social-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
                            <rect x="2" y="9" width="4" height="12"></rect>
                            <circle cx="4" cy="4" r="2"></circle>
                        </svg>
                    </a>
                </div>
            </div>

            <div class="footer-links-column">
                <h3 class="footer-title">Fast Links</h3>
                <ul class="footer-links">
                    <li><a href="#">Feed</a></li>
                    <li><a href="#">Lost&Found</a></li>
                    <li><a href="#">Book Shop</a></li>
                    <li><a href="#">Switch to UniVerse</a></li>
                </ul>
            </div>

            <div class="footer-links-column">
                <h3 class="footer-title">Informations</h3>
                <ul class="footer-links">
                    <li><a href="#">Report a Bug</a></li>
                    <li><a href="#">UniHiVerse@univ-blida.dz</a></li>
                    <li><a href="#">Support:14h-18h</Hours:14h-18h></a></li>
                    <li><a href="#">Conditions</a></li>
                    <li><a href="#">FAQ</a></li>
                </ul>
            </div>

            <div class="contact-info">
                <h3 class="footer-title">Contactez-nous</h3>
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                        <circle cx="12" cy="10" r="3"></circle>
                                    </svg> University Of Saad Dahleb
                </p>
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                                    </svg> By TeenTechTitans
                </p>
            </div>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2025 UniHive. All rights reserved.</p>
        </div>
    </footer>
    <script>
        // Global variables
        let currentUser = null;
        let lostFoundCompleted = false;

        async function loadPosts() {
            try {
                const response = await fetch('/homepage', {
                    credentials: 'include',
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to load posts');
                }

                const data = await response.json();
                renderPosts(data.posts);

                // Update form with user info if available
                if (data.user) {
                    const usernameInput = document.querySelector('.username-input');
                    const userAvatar = document.querySelector('.form-header .user-avatar');

                    if (usernameInput) {
                        usernameInput.value = data.user.username || data.user.full_name;
                    }

                    if (userAvatar && data.user.pfp) {
                        userAvatar.src = `/${data.user.pfp}`;
                    }
                }
            } catch (error) {
                console.error('Error loading posts:', error);
                const container = document.querySelector('.main-feed');
                if (container) {
                    const errorElem = document.createElement('p');
                    errorElem.className = 'error-message';
                    errorElem.textContent = 'Failed to load posts. Please try again later.';
                    container.appendChild(errorElem);
                }
            }
        }

        function setupLostFoundModal() {
            console.log('Setting up Lost & Found modal...');

            // Find all possible select elements for tags
            const possibleSelectors = [
                '#topic-select',
                '#tag-select',
                'select[name="tag"]',
                'select[name="topic"]',
                '.post-form select',
                '.tag-select'
            ];

            let tagSelect = null;
            for (let selector of possibleSelectors) {
                const element = document.querySelector(selector);
                if (element) {
                    tagSelect = element;
                    console.log(`Found tag select with selector: ${selector}`);
                    break;
                }
            }

            if (!tagSelect) {
                console.error('No tag select element found! Tried selectors:', possibleSelectors);
                return;
            }

            // Set up the change event listener
            tagSelect.addEventListener('change', function(e) {
                console.log('Tag selection changed to:', this.value);

                if (this.value === 'lost&found' || this.value === 'lost_found' || this.value === 'lostfound') {
                    showLostFoundModal();
                } else {
                    hideLostFoundModal();
                    // Only reset completion status when changing away from lost&found
                    lostFoundCompleted = false;
                }
            });

            // Set up modal submit button
            setupModalSubmitButton();
        }

        function showLostFoundModal() {
            console.log('Attempting to show Lost & Found modal...');

            // First try to find the backdrop (your actual structure)
            let modalBackdrop = document.getElementById('lostFoundModalBackdrop');
            let modal = document.getElementById('lostFoundModal');

            if (modalBackdrop && modal) {
                console.log('Found modal with backdrop structure');

                // Reset completion status
                lostFoundCompleted = false;

                // Show the backdrop first
                modalBackdrop.style.display = 'block';
                modalBackdrop.style.visibility = 'visible';
                modalBackdrop.style.opacity = '1';

                // Make sure backdrop covers the screen
                modalBackdrop.style.position = 'fixed';
                modalBackdrop.style.top = '0';
                modalBackdrop.style.left = '0';
                modalBackdrop.style.width = '100%';
                modalBackdrop.style.height = '100%';
                modalBackdrop.style.backgroundColor = 'rgba(0,0,0,0.5)';
                modalBackdrop.style.zIndex = '1000';

                // Show the modal content
                modal.style.display = 'block';
                modal.style.visibility = 'visible';
                modal.style.opacity = '1';

                // Center the modal
                modal.style.position = 'fixed';
                modal.style.top = '50%';
                modal.style.left = '50%';
                modal.style.transform = 'translate(-50%, -50%)';
                modal.style.backgroundColor = 'white';
                modal.style.padding = '20px';
                modal.style.borderRadius = '8px';
                modal.style.boxShadow = '0 4px 6px rgba(0,0,0,0.1)';
                modal.style.zIndex = '1001';
                modal.style.maxWidth = '500px';
                modal.style.width = '90%';

                console.log('Modal should now be visible');
                return;
            }

            // Fallback: try other possible selectors
            const possibleModalSelectors = [
                '#lostFoundModal',
                '#lost-found-modal',
                '.lost-found-modal',
                '#lostfound-modal'
            ];

            let foundModal = null;
            for (let selector of possibleModalSelectors) {
                const element = document.querySelector(selector);
                if (element) {
                    foundModal = element;
                    console.log(`Found modal with selector: ${selector}`);
                    break;
                }
            }

            if (foundModal) {
                // Reset completion status
                lostFoundCompleted = false;

                // Show the modal
                foundModal.style.display = 'block';
                foundModal.style.visibility = 'visible';
                foundModal.style.opacity = '1';
                foundModal.style.position = 'fixed';
                foundModal.style.top = '50%';
                foundModal.style.left = '50%';
                foundModal.style.transform = 'translate(-50%, -50%)';
                foundModal.style.backgroundColor = 'white';
                foundModal.style.padding = '20px';
                foundModal.style.borderRadius = '8px';
                foundModal.style.zIndex = '1000';

                console.log('Modal should now be visible');
            } else {
                console.error('Modal not found! Creating fallback modal...');
                createFallbackModal();
            }
        }

        function hideLostFoundModal() {
            // Hide backdrop first
            const modalBackdrop = document.getElementById('lostFoundModalBackdrop');
            if (modalBackdrop) {
                modalBackdrop.style.display = 'none';
                modalBackdrop.style.visibility = 'hidden';
                modalBackdrop.style.opacity = '0';
            }

            // Then hide the modal itself
            const modal = document.querySelector('#lostFoundModal, #lost-found-modal, .lost-found-modal, #lostfound-modal');
            if (modal) {
                modal.style.display = 'none';
                modal.style.visibility = 'hidden';
                modal.style.opacity = '0';
            }

            // DON'T reset completion status when hiding after successful completion
            // Only reset when canceling or changing tags
        }

        function createFallbackModal() {
            console.log('Creating fallback modal...');

            const modal = document.createElement('div');
            modal.id = 'lostFoundModal';
            modal.innerHTML = `
        <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;">
            <div style="background: white; padding: 20px; border-radius: 8px; max-width: 500px; width: 90%;">
                <h3>Lost & Found Information</h3>
                <div style="margin: 10px 0;">
                    <label><input type="radio" name="type" value="lost"> Lost Item</label><br>
                    <label><input type="radio" name="type" value="found"> Found Item</label>
                </div>
                <div style="margin: 10px 0;">
                    <label>Location:</label><br>
                    <input type="text" name="location" style="width: 100%; padding: 5px;" placeholder="Where was it lost/found?">
                </div>
                <div style="margin: 10px 0;">
                    <label>Contact Information:</label><br>
                    <input type="text" name="contact" style="width: 100%; padding: 5px;" placeholder="Email or phone number">
                </div>
                <div style="margin: 10px 0;">
                    <label>Description:</label><br>
                    <textarea id="lost-found-response" style="width: 100%; padding: 5px; height: 80px;" placeholder="Describe the item..."></textarea>
                </div>
                <div style="text-align: right; margin-top: 15px;">
                    <button id="modalCancel" style="margin-right: 10px; padding: 8px 16px;">Cancel</button>
                    <button id="modalSubmit" style="padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px;">Submit</button>
                </div>
            </div>
        </div>
    `;

            document.body.appendChild(modal);

            // Set up the submit button for the fallback modal
            setupModalSubmitButton();

            // Set up cancel button
            document.getElementById('modalCancel').addEventListener('click', function() {
                hideLostFoundModal();
                // Reset the tag select to default
                const tagSelect = document.querySelector('#topic-select, select[name="tag"], .post-form select');
                if (tagSelect) {
                    tagSelect.selectedIndex = 0;
                }
            });

            // Show the modal
            modal.style.display = 'block';
        }

        function setupModalSubmitButton() {
            const modalSubmit = document.getElementById('modalSubmit');
            if (modalSubmit) {
                modalSubmit.addEventListener('click', function() {
                    console.log('Modal submit clicked');
                    const type = document.querySelector('input[name="type"]:checked');
                    const location = document.querySelector('input[name="location"]');
                    const contact = document.querySelector('input[name="contact"]');
                    const description = document.getElementById('lost-found-response');
                    const imageInput = document.getElementById("lost-found-image");

                    if (!type || !location || !location.value.trim() || !contact || !contact.value.trim() || !description || !description.value.trim()) {
                        alert('Please fill out all Lost & Found fields.');
                        return;
                    }

                    // Format the content for the main post
                    const formatted = `ðŸ” ${type.value === 'lost' ? 'Lost Item' : 'Found Item'}\nðŸ“ Location: ${location.value}\nðŸ“ž Contact: ${contact.value}\nðŸ“ Description: ${description.value}`;

                    // Get the main textarea and set its value
                    const mainTextarea = document.querySelector('.post-textarea');
                    if (mainTextarea) {
                        mainTextarea.value = formatted;
                    }

                    // Store the data for form submission
                    window.lostFoundData = {
                        type: type.value,
                        location: location.value,
                        contact: contact.value,
                        description: description.value,
                        imageFile: imageInput.files.length > 0 ? imageInput.files[0] : null
                    };

                    // Mark as completed and hide modal
                    lostFoundCompleted = true;
                    hideLostFoundModal();

                    // Focus the main textarea so user can edit or post
                    if (mainTextarea) {
                        mainTextarea.focus();
                    }
                });
            }
        }

        function setupPostForm() {
            const postForm = document.querySelector('.post-form');
            if (!postForm) return;

            postForm.addEventListener('submit', async function(e) {
                e.preventDefault();

                const formData = new FormData(this);
                const tagSelect = this.querySelector('select[name="tags"]');
                const selectedTag = tagSelect ? tagSelect.value : null;

                // Check if lost&found is selected but not completed
                if ((selectedTag === 'lost&found') && !lostFoundCompleted) {
                    alert('Please complete the Lost & Found information before submitting.');
                    showLostFoundModal();
                    return;
                }

                // Add lost & found data to form if completed
                if (lostFoundCompleted && window.lostFoundData) {
                    formData.append('lostfound_type', window.lostFoundData.type);
                    formData.append('location', window.lostFoundData.location);
                    formData.append('contact', window.lostFoundData.contact);
                    formData.append('lost_found_response', window.lostFoundData.description);

                    // Add the image file if one was selected in the modal
                    if (window.lostFoundData.imageFile) {
                        formData.append('image', window.lostFoundData.imageFile);
                    }
                }

                try {
                    const response = await fetch('/posts', {
                        method: 'POST',
                        body: formData,
                        credentials: 'include'
                    });

                    if (!response.ok) {
                        throw new Error('Failed to create post');
                    }

                    // Clear form and reset state
                    clearForm();
                    lostFoundCompleted = false;
                    window.lostFoundData = null;
                    await loadPosts();

                } catch (error) {
                    console.error('Error creating post:', error);
                    alert('Failed to create post: ' + error.message);
                }
            });
        }
        // Helper function to clear form
        function clearForm() {
            // Clear main form
            const postTextarea = document.querySelector('.post-textarea');
            const imageUpload = document.getElementById('image-upload');
            const fileNameDisplay = document.getElementById('selected-file-name');
            const tagSelect = document.querySelector('#topic-select');

            if (postTextarea) postTextarea.value = '';
            if (imageUpload) imageUpload.value = '';
            if (fileNameDisplay) fileNameDisplay.textContent = '';
            if (tagSelect) tagSelect.selectedIndex = 0;

            // Clear modal fields
            const typeInputs = document.querySelectorAll('input[name="type"]');
            typeInputs.forEach(input => input.checked = false);

            const locationInput = document.querySelector('input[name="location"]');
            if (locationInput) locationInput.value = '';

            const contactInput = document.querySelector('input[name="contact"]');
            if (contactInput) contactInput.value = '';

            const descriptionInput = document.getElementById('lost-found-response');
            if (descriptionInput) descriptionInput.value = '';

            const lostFoundImageInput = document.getElementById('lost-found-image');
            if (lostFoundImageInput) lostFoundImageInput.value = '';
        }
        // Function to render posts
        function renderPosts(posts) {
            if (!posts || !Array.isArray(posts)) {
                console.error("No posts data available");
                return;
            }

            const container = document.querySelector('.main-feed');
            if (!container) {
                console.error("Main feed container not found");
                return;
            }

            // Clear existing posts but keep form and title
            const existingPosts = container.querySelectorAll('.post');
            existingPosts.forEach(post => post.remove());

            if (posts.length === 0) {
                const emptyMessage = document.createElement('p');
                emptyMessage.textContent = 'No posts yet. Be the first to post!';
                emptyMessage.className = 'empty-posts-message';
                container.appendChild(emptyMessage);
                return;
            }

            // Create and append each post
            posts.forEach(post => {
                        const postElement = document.createElement('article');
                        postElement.className = 'post';
                        postElement.dataset.postId = post.id;

                        const postDate = new Date(post.post_date).toLocaleString();

                        postElement.innerHTML = `
            <header>
                <img class="user-avatar" src="${post.user_pfp}" alt="User avatar" />
                <div class="post-header-text">
                    <h3>${escapeHtml(post.username)}</h3>
                    <span class="post-tag">${escapeHtml(post.tags || 'General')}</span>
                </div>
                <div class="more-options-wrapper">
                    <button class="more-options" aria-label="More options">...</button>
                    <ul class="options-menu">
                        <li><button class="remove-post">Delete</button></li>
                        <li><button class="report-post">Report</button></li>
                    </ul>
                </div>
            </header>
           <p class="post-content">${escapeHtml(post.content).replace(/\n/g, '<br>')}</p>
            ${post.image_url ? `<img src="${post.image_url}" class="uploaded-image" alt="Post image" />` : ''}
            
            <p class="timestamp">Posted on ${postDate}</p>
            <footer>
                <button class="like-button ${post.user_liked ? 'liked' : ''}" 
                        data-post-id="${post.id}">
                    <i class="${post.user_liked ? 'fas' : 'far'} fa-thumbs-up"></i>
                    <span class="like-count">${post.likes || 0}</span>
                </button>
                <button class="comment-button">
                    <i class="far fa-comment-dots"></i>
                </button>
            </footer>
            <div class="comment-section">
                <textarea class="comment-input" placeholder="Write a comment..." maxlength="300"></textarea>
                <button class="submit-comment">
                    <i class="far fa-paper-plane"></i> Comment
                </button>
                <div class="comments-list"></div>
            </div>
        `;
        
        container.appendChild(postElement);
    });
    
    // Set up interactions for the new posts
    setupPostInteractions();
}

// Helper function to escape HTML (prevent XSS)
function escapeHtml(unsafe) {
    if (typeof unsafe !== 'string') return '';
    return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
}

// Function to set up post interactions (likes, comments, etc.)
function setupPostInteractions() {
    // Like button functionality
    document.querySelectorAll('.like-button').forEach(button => {
        button.addEventListener('click', async function() {
            const postId = this.dataset.postId;
            const isLiked = this.classList.contains('liked');
            const likeCountEl = this.querySelector('.like-count');
            
            try {
                const response = await fetch('/posts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    credentials: 'include',
                    body: JSON.stringify({
                        action: 'toggle_like',
                        post_id: postId
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Update UI
                    likeCountEl.textContent = data.likes;
                    this.classList.toggle('liked', data.liked);
                    
                    // Update icon
                    const icon = this.querySelector('i');
                    icon.className = data.liked ? 'fas fa-thumbs-up' : 'far fa-thumbs-up';
                }
            } catch (err) {
                console.error('Error updating like:', err);
            }
        });
    });
    
    // Comment button functionality
    document.querySelectorAll('.comment-button').forEach(button => {
        button.addEventListener('click', function() {
            const post = this.closest('.post');
            const commentSection = post.querySelector('.comment-section');
            commentSection.style.display = 
                commentSection.style.display === 'block' ? 'none' : 'block';
        });
    });
    
    // Submit comment functionality
    document.querySelectorAll('.submit-comment').forEach(button => {
        button.addEventListener('click', function() {
            const post = this.closest('.post');
            const commentInput = post.querySelector('.comment-input');
            const commentsList = post.querySelector('.comments-list');
            
            const commentText = commentInput.value.trim();
            if (!commentText) return;
            
            // Create comment element
            const comment = document.createElement('div');
            comment.className = 'comment-entry';
            
            // Get user info (or use placeholder)
            const userPfp = currentUser && currentUser.pfp ? currentUser.pfp : 'https://c.animaapp.com/m9cq51g1Jevf3Y/img/image-9.png';
            const userName = currentUser && currentUser.username ? currentUser.username : (currentUser && currentUser.full_name ? currentUser.full_name : 'username_');
            
            comment.innerHTML = `
                <img src="${userPfp}" alt="Commenter avatar" class="comment-avatar" />
                <div class="comment-body">
                    <strong>${userName}</strong>
                    <span class="comment-time">${new Date().toLocaleString()}</span>
                    <br>
                    <span class="comment-text">${escapeHtml(commentText).replace(/\n/g, '<br>')}</span>
                    <div class="comment-actions">
                        <button class="edit-comment">Edit</button>
                        <button class="delete-comment">Delete</button>
                    </div>
                </div>
            `;
            
            // Add edit/delete listeners
            comment.querySelector('.edit-comment').addEventListener('click', function() {
                const textSpan = comment.querySelector('.comment-text');
                const newText = prompt('Edit your comment:', textSpan.textContent);
                if (newText !== null) {
                    textSpan.innerHTML = escapeHtml(newText).replace(/\n/g, '<br>');
                }
            });
            
            comment.querySelector('.delete-comment').addEventListener('click', function() {
                comment.remove();
            });
            
            commentsList.appendChild(comment);
            commentInput.value = '';
        });
    });
    
    // More options functionality
    document.querySelectorAll('.more-options').forEach(button => {
        button.addEventListener('click', function(e) {
            e.stopPropagation();
            const menu = this.nextElementSibling;
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        });
    });
    
    // Close menus when clicking elsewhere
    document.addEventListener('click', () => {
        document.querySelectorAll('.options-menu').forEach(menu => {
            menu.style.display = 'none';
        });
    });
    
    // Remove post
    document.querySelectorAll('.remove-post').forEach(button => {
        button.addEventListener('click', function() {
            const post = this.closest('.post');
            post.remove();
        });
    });
    
    // Report post
    document.querySelectorAll('.report-post').forEach(button => {
        button.addEventListener('click', function() {
            alert('ðŸš© This post has been reported.');
        });
    });
}

// Initialize everything when the DOM is fully loaded
document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM loaded, initializing...');
    
    // Fetch user profile
    fetch('/profile', { credentials: 'include' })
        .then(res => {
            if (!res.ok) throw new Error('Not logged in');
            return res.json();
        })
        .then(user => {
            // Store user data globally
            currentUser = user;
            
            // Update navbar profile if it exists
            const profileDiv = document.querySelector('.profile');
            if (profileDiv) {
                profileDiv.innerHTML = `
                    <img src="/${user.pfp}" alt="Profile Picture" class="navbar-pfp profile" />
                `;
            }
            
            // Update form username and avatar
            const formUserAvatar = document.querySelector('.form-header .user-avatar');
            const usernameInput = document.querySelector('.form-header .username-input');
            
            if (formUserAvatar) {
                formUserAvatar.src = `/${user.pfp}`;
            }
            
            if (usernameInput) {
                usernameInput.value = user.username || user.full_name;
            }
        })
        .catch(err => {
            console.warn('Could not load profile:', err);
        });
    
    // Load posts and set up form
    loadPosts();
    setupPostForm();
    setupLostFoundModal();
    
    // Load announcements
    fetch('/api/announcements')
        .then(response => response.json())
        .then(data => {
            const container = document.getElementById('announcement-list');
            if (container) {
                data.forEach(announcement => {
                    const div = document.createElement('div');
                    div.className = 'announcement';

                    const title = document.createElement('h3');
                    title.textContent = announcement.title;

                    const content = document.createElement('p');
                    content.textContent = announcement.content;

                    div.appendChild(title);
                    div.appendChild(content);

                    container.appendChild(div);
                });
            }
        })
        .catch(error => {
            console.error('Error fetching announcements:', error);
        });
    
    // Expose functions globally for debugging
    window.showLostFoundModal = showLostFoundModal;
    window.hideLostFoundModal = hideLostFoundModal;
    window.lostFoundCompleted = () => lostFoundCompleted;
});
    </script>
</body>

</html>